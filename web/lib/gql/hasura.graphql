# Dump uncategorized queries here

query User($id: String!) {
  user_by_pk(id: $id) {
    id
    email
  }
}

query AllProfilesOfUser($user_id: String!) {
  profile(where: { user_id: { _eq: $user_id } }) {
    id
    profile_roles {
      id
      profile_role
    }
    profile_listing {
      id
      public
    }
    flattened_profile_roles {
      id
      profile_id
      profile_role
    }
    space {
      id
      name
      slug
    }
    user {
      id
      email
      first_name
      last_name
    }
  }
}

query SpaceBySlug($slug: String!) {
  space(where: { slug: { _eq: $slug } }) {
    id
    name
    slug
    space_listing_questions(order_by: { listing_order: asc }) {
      char_count
      id
      space_id
      title
      listing_order
    }
  }
}

mutation CreateOwnerProfileInNewSpace(
  $user_id: String!
  $space: space_insert_input!
) {
  insert_profile_one(
    object: {
      space: { data: $space }
      profile_roles: { data: { profile_role: Admin } }
      user_id: $user_id
    }
  ) {
    id
    space_id
    user_id
    space {
      id
      name
      slug
      owner_id
      space_listing_questions {
        char_count
        id
        space_id
        title
      }
    }
  }
}

query InviteLinks($space_id: uuid!) {
  space_invite_link(where: { space_id: { _eq: $space_id } }) {
    id
    expires_at
    created_at
    space_id
    type
  }
}

mutation CreateInviteLink(
  $space_id: uuid!
  $type: space_invite_link_type_enum!
  $expires_at: timestamptz!
) {
  insert_space_invite_link_one(
    object: { space_id: $space_id, type: $type, expires_at: $expires_at }
  ) {
    id
    expires_at
    created_at
    space_id
    type
  }
}

query ProfilesBySpaceId($space_id: uuid!) {
  profile(where: { space_id: { _eq: $space_id } }) {
    id
    user {
      id
      first_name
      last_name
      email
    }
    profile_roles {
      id
      profile_role
    }
    space_id
    user_id
    created_at
  }
}

query SpaceTagCategories($space_id: uuid!) {
  space_tag_category(where: { space_id: { _eq: $space_id } }) {
    space_tags {
      id
      label
    }
    title
    id
  }
}

query ProfileListingToSpaceTag($profile_id: uuid!) {
  profile_listing_to_space_tag(
    where: { profile_listing: { profile_id: { _eq: $profile_id } } }
  ) {
    id
    profile_listing_id
    space_tag_id
    space_tag {
      id
      label
      space_tag_category_id
    }
  }
}

query SpaceTags($space_tag_category_id: uuid!) {
  space_tag(where: { space_tag_category_id: {} }) {
    id
    space_tag_category {
      space_id
      title
    }
  }
}

query ListingResponseByQuestionId($question_id: uuid!) {
  profile_listing_response(
    where: { space_listing_question: { id: { _eq: $question_id } } }
  ) {
    id
    profile_listing_id
    response_html
  }
}

mutation UpsertListingResponses(
  $objects: [profile_listing_response_insert_input!]!
) {
  insert_profile_listing_response(
    objects: $objects
    on_conflict: {
      constraint: profile_listing_response_space_listing_question_id_profile_list
      update_columns: [response_html]
    }
  ) {
    returning {
      id
      profile_listing_id
      response_html
      space_listing_question_id
      profile_listing {
        id
        profile_id
        public
      }
    }
  }
}
